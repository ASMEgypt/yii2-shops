$.widget("execut.MapWidget",{_isInited:false,_create:function(){var a=this,b=a.element,c=function(){a._initMap()};$(document).scroll(function(){if(a.isInViewport()){c()}});if(a.options.isInitAfterLoad){c()}},isInViewport:function(){var d=this.element;var b=$(d).offset().top;var e=b+$(d).outerHeight();var a=$(window).scrollTop();var c=a+$(window).height();return e>a&&b<c},_initMap:function(){var c,a=this,b=a.element;if(a._isInited){return}a._isInited=true;$.getScript("https://api-maps.yandex.ru/2.1/?lang=ru_RU",function(){var d="/images/geop.png";var f=[35,53];var e=[-3,-53];var g=-1;function h(){b.find("img, .map-image").hide();var m=a.options.coords;c=new ymaps.Map(b.attr("id"),{center:m,zoom:10});var l=a.options.shops;g=a.options.openedBaloon;var i=new ymaps.Clusterer({preset:"islands#yellowClusterIcons",groupByCoordinates:false,clusterDisableClickZoom:true,clusterHideIconOnBalloonOpen:false,geoObjectHideIconOnBalloonOpen:false});i.events.add("objectsaddtomap",function(){var o=cluster.getObjectState(myGeoObjects[1]);if(o.isShown){if(o.isClustered){o.cluster.state.set("activeObject",myGeoObjects[1]);o.cluster.balloon.open()}else{myGeoObjects[1].balloon.open()}}});var n=[];l.forEach(function(r,q,o){var s=r.coords.split(",");var p=[];p[0]=parseFloat(s[1]);p[1]=parseFloat(s[0]);var t=new ymaps.Placemark(p,{hintContent:r.hintContent,balloonContentHeader:r.balloonContentHeader,balloonContentBody:r.balloonContentBody},{iconLayout:"default#image",iconImageHref:d,iconImageSize:f,iconImageOffset:e});n[q]=t;i.add(t)});i.options.set({minClusterSize:1,gridSize:80,clusterDisableClickZoom:true,iconLayout:"default#image",iconImageHref:d,iconImageSize:f,iconImageOffset:e});c.geoObjects.add(i);var k=false;b.bind("mouseout",function(){if(k){c.behaviors.disable("scrollZoom");k=false}});c.events.add("mousedown",function(){if(!k){c.behaviors.enable("scrollZoom");k=true}});c.behaviors.disable("scrollZoom");if(g>0){var j=i.getObjectState(n[g]);i.balloon.open(j.cluster)}}ymaps.ready(h)})}});